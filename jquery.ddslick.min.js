(function(b){function m(a,c){var b=a.data("ddslick"),h=a.find(".dd-selected"),l=h.siblings(".dd-selected-value");a.find(".dd-options");h.siblings(".dd-pointer");var e=a.find(".dd-option").eq(c),k=e.closest("li"),j=b.settings,d=b.settings.data[c];a.find(".dd-option").removeClass("dd-option-selected");e.addClass("dd-option-selected");b.selectedIndex=c;b.selectedItem=k;b.selectedData=d;j.showSelectedHTML?h.html((d.cssSprite?'<span class="dd-selected-csssprite'+("right"==j.imagePosition?" dd-image-right "+
d.cssSprite:" dd-image-left "+d.cssSprite)+'" />':"")+(d.imageSrc?'<img class="dd-selected-image'+("right"==j.imagePosition?" dd-image-right":"")+'" src="'+d.imageSrc+'" />':"")+(d.text?'<label class="dd-selected-text">'+d.text+"</label>":"")+(d.description?'<small class="dd-selected-description dd-desc'+(j.truncateDescription?" dd-selected-description-truncated":"")+'" >'+d.description+"</small>":"")):h.html(d.text);l.val(d.value);b.original.val(d.value);a.data("ddslick",b);n(a);h=a.find(".dd-select").css("height");
l=a.find(".dd-selected-description");e=a.find(".dd-selected-image");k=a.find(".dd-selected-csssprite");(0>=l.length&&0<e.length||0>=l.length&&0<k.length)&&a.find(".dd-selected-text").css("lineHeight",h);"function"==typeof j.onSelected&&j.onSelected.call(this,b)}function p(a){var c=a.find(".dd-select"),g=c.siblings(".dd-options"),c=c.find(".dd-pointer"),h=g.is(":visible");b(".dd-click-off-close").not(g).slideUp(50);b(".dd-pointer").removeClass("dd-pointer-up");h?(g.slideUp("fast"),c.removeClass("dd-pointer-up")):
(g.slideDown("fast"),c.addClass("dd-pointer-up"));a.find(".dd-option").each(function(){var c=b(this),e=c.css("height"),k=c.find(".dd-option-description"),j=a.find(".dd-option-image"),d=a.find(".dd-selected-csssprite");(0>=k.length&&0<j.length||0>=k.length&&0<d.length)&&c.find(".dd-option-text").css("lineHeight",e)})}function n(a){a.find(".dd-options").slideUp(50);a.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}b.fn.ddslick=function(a){if(f[a])return f[a].apply(this,
Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return f.init.apply(this,arguments);b.error("Method "+a+" does not exists.")};var f={},q={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,embedCSS:!0,onSelected:function(){}};f.init=function(a){a=b.extend({},q,a);0>=b("#css-ddslick").length&&a.embedCSS&&b('<style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image, .dd-selected-csssprite, dd-image-left{ vertical-align:middle; float:left; margin-right:5px; max-width:64px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;}\u200b .dd-selected-text { font-weight:bold}\u200b</style>').appendTo("head");
return this.each(function(){var c=b(this);if(!c.data("ddslick")){var g=[];c.find("option").each(function(){var a=b(this),c=a.data();g.push({text:b.trim(a.text()),value:a.val(),selected:a.is(":selected"),description:c.description,cssSprite:c.csssprite,imageSrc:c.imagesrc})});a.keepJSONItemsOnTop?b.merge(a.data,g):a.data=b.merge(g,a.data);var h=c,f=b('<div id="'+c.attr("id")+'"></div>');c.replaceWith(f);c=f;c.addClass("dd-container").append('<div class="dd-select"><input class="dd-selected-value" type="hidden" /><a class="dd-selected"></a><span class="dd-pointer dd-pointer-down"></span></div>').append('<ul class="dd-options"></ul>');
var g=c.find(".dd-select"),e=c.find(".dd-options");e.css({width:a.width});g.css({width:a.width,background:a.background});c.css({width:a.width});null!=a.height&&e.css({height:a.height,overflow:"auto"});b.each(a.data,function(c,b){b.selected&&(a.defaultSelectedIndex=c);e.append('<li><a class="dd-option">'+(b.value?' <input class="dd-option-value" type="hidden" value="'+b.value+'" />':"")+(b.cssSprite?' <span class="dd-selected-csssprite'+("right"==a.imagePosition?" dd-image-right "+b.cssSprite:" dd-image-left "+
b.cssSprite)+'" />':"")+(b.imageSrc?' <img class="dd-option-image'+("right"==a.imagePosition?" dd-image-right":"")+'" src="'+b.imageSrc+'" />':"")+(b.text?' <label class="dd-option-text">'+b.text+"</label>":"")+(b.description?' <small class="dd-option-description dd-desc">'+b.description+"</small>":"")+"</a></li>")});c.data("ddslick",{settings:a,original:h,selectedIndex:-1,selectedItem:null,selectedData:null});0<a.selectText.length&&null==a.defaultSelectedIndex?c.find(".dd-selected").html(a.selectText):
m(c,null!=a.defaultSelectedIndex&&0<=a.defaultSelectedIndex&&a.defaultSelectedIndex<a.data.length?a.defaultSelectedIndex:0);c.find(".dd-select").on("click.ddslick",function(){p(c)});c.find(".dd-option").on("click.ddslick",function(){m(c,b(this).closest("li").index())});a.clickOffToClose&&(e.addClass("dd-click-off-close"),c.on("click.ddslick",function(a){a.stopPropagation()}),b("body").on("click",function(){b(".dd-click-off-close").slideUp(50).siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")}))}})};
f.select=function(a){return this.each(function(){void 0!==a.index&&m(b(this),a.index)})};f.open=function(){return this.each(function(){var a=b(this);a.data("ddslick")&&p(a)})};f.close=function(){return this.each(function(){var a=b(this);a.data("ddslick")&&n(a)})};f.destroy=function(){return this.each(function(){var a=b(this),c=a.data("ddslick");c&&(c=c.original,a.removeData("ddslick").unbind(".ddslick").replaceWith(c))})}})(jQuery);